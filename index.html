<!DOCTYPE html>
<html>
<head>
  <title>ü§ñ Robo Delivery ùïè | Next-Gen Groceries</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <style>
    body {
      background: linear-gradient(135deg,#212cfc 0%,#0fffc0 100%);
      min-height:100vh;margin:0;
      font-family:'Segoe UI',Arial;
      background-attachment:fixed;
    }
    .header {
      background:linear-gradient(120deg,#1f084f 65%,#0fffc0 120%);
      color:#fff; padding:38px 0 28px 0;font-size:2.8em;letter-spacing:.045em;text-align:center;
      font-weight:900; border-bottom-left-radius: 44px; border-bottom-right-radius:44px; 
      text-shadow:0 11px 30px #2fffff88,0 2px 0 #0ff5cb;
      box-shadow:0 14px 66px #30fff582;
      display: flex; flex-direction:column; align-items: center; justify-content: center;
    }
    .robo-mascot {margin-top:-56px;margin-bottom:-16px;animation:floaty .9s infinite alternate cubic-bezier(.3,1.5,.7,1.01);}
    .robo-mascot svg {filter:drop-shadow(0 4px 18px #0fffa999);}
    @keyframes floaty {from{transform:translateY(0);}to{transform:translateY(14px);}}
    .main { max-width:550px; margin:14px auto 8px auto; }
    .banner {
      background: rgba(34,49,120,.74);
      margin:28px 0 14px 0;
      padding:19px 19px 15px 19px;
      border-radius:19px;
      font-size:1.18em;
      color:#0fffc0;
      font-family:'Segoe UI',Arial,sans-serif;
      font-weight:800;
      letter-spacing:.03em;
      box-shadow:0 4px 63px #16fff79d,0 4px 23px #2d81f7cd,0 0px 0 #fff7;
      text-align:center; position:relative; overflow:hidden;
      border: 3px solid #0fffc0;
    }
    .banner::after {
      content:"";
      position:absolute;
      top:0;left:0;right:0;bottom:0;
      background: linear-gradient(120deg,transparent .5%,#0fffc0 35%,transparent 70%);
      opacity:0.14;
      z-index:0;
      pointer-events:none;
    }
    .grid {display:flex;flex-wrap:wrap;gap:17px;justify-content:center;margin-bottom:10px;}
    .prod {
      background:linear-gradient(135deg,#fff 54%,#a0ffee 100%);
      border-radius:27px;box-shadow:0 10px 44px #0fffc080;
      width:164px;position:relative;padding:23px 13px 41px 13px;
      display:flex;flex-direction:column;align-items:center;
      transition:transform .33s,box-shadow .33s;}
    .prod:hover {transform:translateY(-15px) scale(1.07);box-shadow:0 15px 55px #08dedddd;}
    .prod img {width:74px;height:74px;border-radius:21px;box-shadow:0 2px 13px #e4fffbf8;border:2.4px solid #0fffc0;}
    .prod-name {font-size:1.23em;font-weight:900;padding-top:5px;color:#292929;letter-spacing:.07em;}
    .prod-price {color:#007aa7;font-size:1.09em;font-weight:800;}
    .qty-row {display:flex;align-items:center;justify-content:center;gap:13px;margin-top:7px;}
    .qty-btn {background:linear-gradient(90deg,#0e1fd7 74%,#0fffc0 100%);
      color:#fff;font-size:1.15em;font-weight:900;border:none;box-shadow:0 3px 14px #aef9ffa2;
      padding:6px 18px;border-radius:13px;cursor:pointer;}
    .qty-btn:active {background:linear-gradient(90deg,#0fffc0 0,#0e1fd7 100%);}
    .qty-num {min-width:32px;text-align:center;font-size:1.26em;color:#0fc9fd;font-weight:900;}
    .cart-bar {
      background:linear-gradient(90deg,#04235b 90%,#0fffc0 150%);
      border-radius:27px;max-width:490px;margin:22px auto 0;padding:22px 25px 21px 25px;
      box-shadow:0 3px 18px #0fffff80;display:flex;flex-direction:column;align-items:flex-start;color:#fff;
    }
    .cart-title {font-weight:900;font-size:1.23em;margin-bottom:7px;letter-spacing:0.03em;}
    .cart-badge {
      background:#0fffc0;color:#2e10ca;font-weight:900;border-radius:50%;width:37px;height:37px;text-align:center;display:inline-block;margin-left:6px;
      font-size:1.13em;box-shadow:0 2px 13px #fff;}
    .cart-item-row {display:flex;align-items:center;gap:11px;margin-bottom:8px;}
    .cart-item-name {font-size:1em;font-weight:800;}
    .cart-item-qty {color:#57fff9;font-size:1em;}
    .cart-item-price {font-size:1em;color:#fdff75;}
    .cart-rm-btn {background:linear-gradient(90deg,#0097ff 70%,#0fffc0 100%);color:#fff;
      border:none;border-radius:9px;font-size:1em;padding:3px 13px;cursor:pointer;box-shadow:0 2px 7px #f7ffffad;}
    .cart-rm-btn:active{background:linear-gradient(90deg,#0fffc0 0,#0097ff 100%);}
    .cart-total {color:#ff3bb5;font-weight:900;font-size:1.24em;margin:18px 0 9px 0;}
    .user-card {
      background:linear-gradient(110deg,#f3fffd 56%,#cdfff9 100%);
      border-radius:31px;padding:33px 22px 24px 22px;margin:16px auto 0 auto;
      max-width:420px;box-shadow:0 8px 22px #caf7f7;
    }
    input,select {
      width:96%;border-radius:14px;margin-bottom:23px;font-size:22px;padding:12px;
      border:2.4px solid #0fffc0;background: rgba(253,253,253,.83);font-weight:700;}
    .order-btn {
      font-family:inherit;
      background: linear-gradient(100deg,#0fffc0 24%,#1e36be 95%);
      color:#fff;font-weight:900;font-size:2.24em;border:none;
      border-radius:35px;
      box-shadow:0 6px 44px #0fffc060,0 2px 4px #c0fffaab;
      display:block; width:95%; margin:34px auto 0 auto; padding:27px 0;
      letter-spacing:.03em; cursor:pointer;
      animation:popOrderBtn 1.33s;transition:box-shadow .23s,transform .17s,background .19s;
      position:relative; z-index:10;}
    .order-btn:hover {
      background:linear-gradient(110deg,#1e36be 15%,#0fffc0 85%);
      box-shadow:0 14px 48px #55fff4c2,0 2px 4px #00ffd0cf;
      transform:scale(1.07) translateY(-4px);}
    @keyframes popOrderBtn{from{opacity:0;transform:scale(.67) translateY(70px);}62%{transform:scale(1.13) translateY(-2px);}to{opacity:1;transform:none;}}
    .statusbar {
      background:linear-gradient(85deg,#1e36be 10%,#0fffc0 100%);
      color:#fafaff; padding:19px 0 19px 0;font-size:1.34em;
      border-radius:22px;text-align:center;margin:26px auto 16px auto;
      box-shadow:0 2px 31px #67fffaad;
      width:98%;display:flex;align-items:center;gap:10px;justify-content:center;}
    .statusbar .emoji {font-size:1.64em;}
    .robo-unlock-card {
      background: rgba(26,34,84, .92);
      border: 2.5px solid #0fffc0;
      box-shadow: 0 4px 72px #0fffc0c2, 0 2px 17px #21ffab88;
      border-radius: 18px;
      margin: 32px 0 5px 0;
      padding: 29px 22px;
      color: #0fffc0;
      text-align: left;
      font-size: 1.15em;
      font-weight: 800;
      letter-spacing: .03em;
      position: relative;
      z-index: 10;
      max-width: 390px;
      margin-left: auto; margin-right: auto;
      text-shadow: 0 4px 22px #00fff0, 0 1px 3px #011f2b;
    }
    .robo-unlock-card .robo-face {
      position: absolute; top: -40px; left: 44%; font-size: 2.8em; filter: drop-shadow(0 3px 18px #0fffc0b2);}
    .robo-unlock-card ul {
      margin: 20px 0 0 14px;
      padding-left: 17px;
      font-size: 1.09em;
      line-height: 2.1em;
      color: #fff;
      text-shadow: none;
      font-weight: 700;
    }
    .robo-unlock-card li {color:#fff;}
    .modal {display:none;position:fixed;left:50%;top:43%;transform:translate(-50%,-43%);
      background:linear-gradient(115deg,#0fffc0 57%,#210cbc 105%);
      box-shadow:0 27px 98px #0ff2fc88;border-radius:44px;padding:74px 74px;z-index:10;color:#fff;
      animation:rotatein .6s cubic-bezier(.5,.1,.4,1.1);}
    .modal.show{display:block;}
    @keyframes rotatein{from{opacity:0;transform:translate(-50%,-120px) rotate(-44deg);}to{opacity:1;transform:translate(-50%,-43%) rotate(0);}
    }
    .close-btn {background: linear-gradient(90deg,#0fffc0 10%,#3242c9 100%);color:#fff;font-size:1.28em;font-weight:900;
      border:none;border-radius:32px;padding:23px 68px;margin-top:39px;box-shadow:0 7px 38px #0fffc086;cursor:pointer;}
    @media(max-width:700px){
      .main{max-width:99vw}.prod{width:46vw}
      .modal{padding:22px 12px;}
      .order-btn{font-size:1.33em;padding:15px 0;}
      .robo-unlock-card{padding:19px 9px;}
      .header{font-size:1.6em;}
    }
  </style>
</head>
<body>
  <div class="header">
      <span class="robo-mascot">
        <!-- SVG animated robo head -->
        <svg width="47" height="42" viewBox="0 0 47 43"><ellipse cx="23.5" cy="24" rx="18" ry="17" fill="#1e36be" stroke="#0fffc0" stroke-width="3"/><ellipse cx="15.5" cy="22" rx="4.5" ry="7" fill="#fff"/><ellipse cx="31.5" cy="22" rx="4.5" ry="7" fill="#fff"/><ellipse cx="15.5" cy="22" rx="2.1" ry="3.5" fill="#00e7e7"/><ellipse cx="31.5" cy="22" rx="2.1" ry="3.5" fill="#00e7e7"/><rect x="15" y="34" width="17" height="6" rx="3" fill="#0fffc0" opacity=".9"/><rect x="20" y="10" width="7" height="7" rx="3.5" fill="#fff"/><ellipse cx="10" cy="23" rx="1.5" ry="2" fill="#fff" opacity=".6"/><ellipse cx="37" cy="23" rx="1.5" ry="2" fill="#fff" opacity=".6"/></svg>
      </span>
      ROBO DELIVERY <span style="color:#0fffc0;text-shadow:0 12px 44px #0fffa933,0 2px 0 #00fff6;">ùïè Next-Gen Groceries</span>
  </div>
  <div class="main">
    <div class="banner">üöö Delivery by AI Robo: order now and see the future in action!</div>
    <div class="grid" id="catalog"></div>
    <div class="cart-bar" id="cartBar" style="display:none;">
      <div class="cart-title">Live CART
        <span class="cart-badge" id="cartBadge" style="display:none;">0</span>
      </div>
      <div id="cartItems"></div>
      <div class="cart-total" id="cartTotal"></div>
    </div>
    <div class="user-card">
      <select id="location">
        <option>Select Location</option>
        <option>Block A</option><option>Block B</option>
        <option>Library</option><option>Hostel</option>
        <option>Lab 1</option><option>Lab 2</option>
        <option>Staffroom</option>
      </select>
      <input id="name" placeholder="Your Name">
      <input id="password" type="password" autocomplete="off" placeholder="Set 6-digit Password">
      <button class="order-btn" onclick="placeOrder()">PLACE ORDER üöÄ</button>
      <div class="statusbar" id="status"><span class="emoji">‚åõ</span> Waiting for order...</div>
    </div>
    <div class="robo-unlock-card">
      <span class="robo-face">ü§ñ</span>
      <span style="font-size:1.07em;line-height:2.2em;">
      <b style="color:#0fffc0; font-size:1.09em; text-shadow: 0 5px 32px #0fffa999, 0 1px 1px #fff;">
        Robo Unlock Steps: <br>
      </b>
      <ul>
        <li>Enter <b style="color:#0fffc0">6-digit Password</b> on the robot's keypad, then press <b style="color:#0fffc0">C</b></li>
        <li>Enter <b style="color:#0fffc0">6-digit OTP</b> (shown after arrival), then press <b style="color:#0fffc0">C</b></li>
        <li>Box opens if <b>both</b> correct!</li>
      </ul>
      </span>
    </div>
  </div>
  <div class="modal" id="otpModal">
    <h2 style="color:#fff;margin-top:0;margin-bottom:17px;text-align:center;letter-spacing:0.045em;">
      Your Delivery <span style="color:#0fffc0;">OTP</span>
    </h2>
    <div id="otpText" style="font-size:2.2em;color:#0fffc0;text-align:center;padding-bottom:17px;letter-spacing:.22em;"></div>
    <button class="close-btn" onclick="closeModal()">Close</button>
  </div>
  <script>
const products = [
  {name:"Potato (1kg)",price:22,img:"https://images.pexels.com/photos/4110255/pexels-photo-4110255.jpeg"},
  {name:"Tomato (1kg)",price:19,img:"https://images.pexels.com/photos/1435906/pexels-photo-1435906.jpeg"},
  {name:"Milk 500ml",price:27,img:"https://images.pexels.com/photos/65175/pexels-photo-65175.jpeg"},
  {name:"Apples (4)",price:50,img:"https://images.pexels.com/photos/102104/pexels-photo-102104.jpeg"},
  {name:"Brown Bread",price:32,img:"https://images.pexels.com/photos/461382/pexels-photo-461382.jpeg"},
  {name:"Onion (1kg)",price:15,img:"https://images.pexels.com/photos/742755/pexels-photo-742755.jpeg"},
  {name:"Rice Pack 1kg",price:78,img:"https://images.pexels.com/photos/461382/pexels-photo-461382.jpeg"},
  {name:"Eggs (6)",price:34,img:"https://images.pexels.com/photos/162712/pexels-photo-162712.jpeg"},
  {name:"Curd 200g",price:18,img:"https://images.pexels.com/photos/161514/pexels-photo-161514.jpeg"}
];
const API = "https://robo-delivery-backend-production.up.railway.app"; // <--- Edit to your Railway backend!
let cart = [];
function renderCatalog() {
  let h = "";
  products.forEach((p,i)=>{
    h+=`<div class="prod">
      <img src="${p.img}" alt="prod">
      <div class="prod-name">${p.name}</div>
      <div class="prod-price">‚Çπ${p.price}</div>
      <div class="qty-row">
        <button class="qty-btn" onclick="changeQty(${i},-1)">‚àí</button>
        <span class="qty-num">${cart.find(x=>x.idx==i)?.qty||0}</span>
        <button class="qty-btn" onclick="changeQty(${i},1)">+</button>
      </div>
    </div>`;
  });
  catalog.innerHTML = h;
}
function changeQty(idx,delta){
  let found = cart.find(x=>x.idx==idx);
  if(found) {
    found.qty += delta;
    if(found.qty<=0) cart = cart.filter(x=>x.idx!=idx);
  } else if(delta>0) {
    cart.push({idx:idx,qty:1});
  }
  renderCatalog(); renderCart();
}
function renderCart() {
  if(!cart.length) { cartBar.style.display="none"; cartBadge.style.display="none"; return;}
  cartBar.style.display="block";
  cartBadge.style.display="inline-block";
  cartBadge.innerText=cart.reduce((n,x)=>n+x.qty,0);
  cartItems.innerHTML = cart.map(x=>{
    let p = products[x.idx];
    return `<div class="cart-item-row">
      <span class="cart-item-name">${p.name}</span>
      <span class="cart-item-qty">x${x.qty}</span>
      <span class="cart-item-price">‚Çπ${p.price*x.qty}</span>
      <button class="cart-rm-btn" onclick="removeFromCart(${x.idx})">Remove</button>
    </div>`;
  }).join("");
  cartTotal.innerHTML = "Total: ‚Çπ"+cart.reduce((s,x)=>s+products[x.idx].price*x.qty,0);
}
function removeFromCart(idx) {
  cart = cart.filter(x=>x.idx!=idx);
  renderCatalog(); renderCart();
}
function placeOrder() {
  if(!cart.length) { status.innerHTML='<span class="emoji">üõí</span> Add to cart!'; return; }
  let items = cart.map(x=>products[x.idx].name+" x"+x.qty).join(", ");
  fetch(API + "/orders", {
    method: "POST",
    headers: {'Content-Type':'application/json'},
    body: JSON.stringify({
      name: name.value,
      location: location.value,
      item: items,
      password: password.value
    })})
    .then(r=>r.json()).then(out=>{
      status.innerHTML = '<span class="emoji">‚è≥</span> Order Placed - Waiting for Shopkeeper!';
      setTimeout(refreshStatus, 1200);
      cart=[]; renderCart(); renderCatalog();
    });
}
function refreshStatus() {
  fetch(API + "/orders")
   .then(res => res.json())
   .then(data => {
     let txt="", ico="‚åõ";
     // You need to find your order by name or latest.
     let order = Array.isArray(data) ? data.find(o => o.name === name.value) : data;
     if (!order) { txt="Waiting for order..."; ico="‚åõ"; }
     else if (order.status=="ORDERED") {txt="Order Placed - Waiting for Shopkeeper!"; ico="üõí";}
     else if (order.status=="DISPATCHED") {txt="Robo Delivering!"; ico="ü§ñ";}
     else if (order.status=="ARRIVED_AT_CUSTOMER") {
       txt=`Robo arrived! Enter password then OTP (shown on arrival) at robot keypad with 'C'`;
       ico="üîë"; showOTP(order.otp);
     }
     else if (order.status=="DELIVERY_COMPLETED") {txt="Delivered! Box unlocked."; ico="‚úÖ";}
     status.innerHTML = `<span class="emoji">${ico}</span> ${txt}`;
   });
}
function showOTP(code) {
  if (!code) return;
  otpText.innerText = code;
  otpModal.classList.add("show");
}
function closeModal() { otpModal.classList.remove("show"); }
renderCatalog();
renderCart();
// You might want to implement an event-based or order ID-based check here for status polling.
setInterval(refreshStatus, 2000);
refreshStatus();
  </script>
</body>
</html>
